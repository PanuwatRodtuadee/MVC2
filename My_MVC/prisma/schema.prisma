// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// 1. ตารางข่าวลือ (Rumor)
model Rumor {
  id               String   @id // ใช้ String เพื่อให้เก็บเลข 0 นำหน้าได้ (เช่น 01234567)
  title            String
  content          String
  created_at       DateTime @default(now())
  credibility_score Int      @default(50) // คะแนนความน่าเชื่อถือ
  status           String   @default("normal") // normal / panic
  
  reports          Report[]
}

// 2. ตารางผู้ใช้งาน (Users)
model User {
  id      Int      @id @default(autoincrement())
  name    String
  role    String   @default("general") // general / auditor
  reports Report[]
}

// 3. ตารางการรายงาน (Report)
model Report {
  id          Int      @id @default(autoincrement())
  report_date DateTime @default(now())
  type        String   // บิดเบือน / ปลุกปั่น / ข้อมูลเท็จ
  
  rumor       Rumor    @relation(fields: [rumorId], references: [id])
  rumorId     String
  
  user        User     @relation(fields: [userId], references: [id])
  userId      Int

  // กฎ: 1 User รายงานข่าวเดิมซ้ำไม่ได้ (Business Rule ข้อ 1)
  @@unique([rumorId, userId])
}